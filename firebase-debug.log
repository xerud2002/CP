[debug] [2025-12-12T20:44:59.619Z] ----------------------------------------------------------------------
[debug] [2025-12-12T20:44:59.621Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\Cip\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js deploy --only firestore
[debug] [2025-12-12T20:44:59.621Z] CLI Version:   15.0.0
[debug] [2025-12-12T20:44:59.621Z] Platform:      win32
[debug] [2025-12-12T20:44:59.621Z] Node Version:  v22.15.1
[debug] [2025-12-12T20:44:59.622Z] Time:          Fri Dec 12 2025 20:44:59 GMT+0000 (Greenwich Mean Time)
[debug] [2025-12-12T20:44:59.622Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-12-12T20:45:01.086Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-12-12T20:45:01.086Z] > authorizing via signed-in user (ciprian.rotopanescu@gmail.com)
[debug] [2025-12-12T20:45:01.086Z] [iam] checking project curierulperfect for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-12-12T20:45:01.087Z] Checked if tokens are valid: false, expires at: 1765557708686
[debug] [2025-12-12T20:45:01.087Z] Checked if tokens are valid: false, expires at: 1765557708686
[debug] [2025-12-12T20:45:01.087Z] > refreshing access token with scopes: []
[debug] [2025-12-12T20:45:01.089Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-12-12T20:45:01.089Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-12-12T20:45:01.237Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-12-12T20:45:01.237Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-12-12T20:45:01.243Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/curierulperfect:testIamPermissions [none]
[debug] [2025-12-12T20:45:01.243Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/curierulperfect:testIamPermissions x-goog-quota-user=projects/curierulperfect
[debug] [2025-12-12T20:45:01.243Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/curierulperfect:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-12-12T20:45:01.870Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/curierulperfect:testIamPermissions 200
[debug] [2025-12-12T20:45:01.870Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/curierulperfect:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'curierulperfect'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-12-12T20:45:01.873Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:01.873Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:01.873Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default) [none]
[debug] [2025-12-12T20:45:02.008Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default) 200
[debug] [2025-12-12T20:45:02.008Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default) {"name":"projects/curierulperfect/databases/(default)","uid":"7ff09d75-2a03-4645-a0d4-72922334f8d2","createTime":"2025-03-30T19:51:47.032263Z","updateTime":"2025-03-30T19:51:47.032263Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-12-12T19:45:02.978964Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IOT4xq/1uJEDMKmEhMWlzowD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-12-12T20:45:02.010Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:02.010Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:02.010Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect:test [none]
[debug] [2025-12-12T20:45:02.010Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect:test [omitted]
[debug] [2025-12-12T20:45:02.319Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect:test 200
[debug] [2025-12-12T20:45:02.319Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect:test {}
[info] +  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-12-12T20:45:02.320Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:02.320Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:02.320Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/curierulperfect/releases pageSize=10&pageToken=
[debug] [2025-12-12T20:45:02.490Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/curierulperfect/releases 200
[debug] [2025-12-12T20:45:02.490Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/curierulperfect/releases {"releases":[{"name":"projects/curierulperfect/releases/cloud.firestore","rulesetName":"projects/curierulperfect/rulesets/d839328b-6555-4bb1-8b07-c448070cc67c","createTime":"2025-03-30T19:51:52.779821Z","updateTime":"2025-12-12T15:45:22.544393Z"},{"name":"projects/curierulperfect/releases/firebase.storage/curierulperfect.firebasestorage.app","rulesetName":"projects/curierulperfect/rulesets/e2999e37-4994-4193-ad71-70676bada5fb","createTime":"2025-12-10T20:14:06.565572Z","updateTime":"2025-12-11T11:49:06.030006Z"}]}
[debug] [2025-12-12T20:45:02.501Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:02.501Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:02.501Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets/d839328b-6555-4bb1-8b07-c448070cc67c [none]
[debug] [2025-12-12T20:45:03.132Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets/d839328b-6555-4bb1-8b07-c448070cc67c 200
[debug] [2025-12-12T20:45:03.132Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets/d839328b-6555-4bb1-8b07-c448070cc67c [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-12-12T20:45:03.134Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:03.134Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:03.134Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets [none]
[debug] [2025-12-12T20:45:03.134Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets [omitted]
[debug] [2025-12-12T20:45:03.933Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets 200
[debug] [2025-12-12T20:45:03.933Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/curierulperfect/rulesets {"name":"projects/curierulperfect/rulesets/41e0a8c2-b8be-49bb-9743-95605b0842a4","source":{"files":[{"content":"rules_version = '2';\r\nservice cloud.firestore {\r\n  match /databases/{database}/documents {\r\n    \r\n    // Helper function to check if user is authenticated\r\n    function isAuthenticated() {\r\n      return request.auth != null;\r\n    }\r\n    \r\n    // Users collection - allow authenticated users to read/write their own data\r\n    match /users/{userId} {\r\n      // Allow read if authenticated and (document ID matches OR uid field matches)\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated();\r\n      allow update: if isAuthenticated() && \r\n        (request.auth.uid == userId || resource.data.uid == request.auth.uid);\r\n      allow delete: if isAuthenticated() && \r\n        (request.auth.uid == userId || resource.data.uid == request.auth.uid);\r\n    }\r\n    \r\n    // Tarife curier collection\r\n    match /tarife_curier/{docId} {\r\n      // Couriers can read/write their own tariffs\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated() && request.resource.data.uid == request.auth.uid;\r\n      allow update, delete: if isAuthenticated() && resource.data.uid == request.auth.uid;\r\n    }\r\n    \r\n    // Zona acoperire collection\r\n    match /zona_acoperire/{docId} {\r\n      // Couriers can read/write their own coverage zones\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated() && request.resource.data.uid == request.auth.uid;\r\n      allow update, delete: if isAuthenticated() && resource.data.uid == request.auth.uid;\r\n    }\r\n    \r\n    // Calendar colectii collection\r\n    match /calendar_colectii/{docId} {\r\n      // Couriers can manage their calendar\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated() && request.resource.data.courierId == request.auth.uid;\r\n      allow update, delete: if isAuthenticated() && resource.data.courierId == request.auth.uid;\r\n    }\r\n    \r\n    // Profil curier collection\r\n    match /profil_curier/{userId} {\r\n      // Couriers can read/write their own profile\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated() && userId == request.auth.uid;\r\n      allow update: if isAuthenticated() && userId == request.auth.uid;\r\n      allow delete: if isAuthenticated() && userId == request.auth.uid;\r\n    }\r\n    \r\n    // Profil client collection\r\n    match /profil_client/{userId} {\r\n      // Clients can read/write their own profile\r\n      allow read: if isAuthenticated() && userId == request.auth.uid;\r\n      allow create: if isAuthenticated() && userId == request.auth.uid;\r\n      allow update: if isAuthenticated() && userId == request.auth.uid;\r\n      allow delete: if isAuthenticated() && userId == request.auth.uid;\r\n    }\r\n    \r\n    // Comenzi collection\r\n    match /comenzi/{docId} {\r\n      // Clients can read their own orders\r\n      // Couriers can read all pending orders and their assigned orders\r\n      allow read: if isAuthenticated() && \r\n        (resource.data.uid_client == request.auth.uid || \r\n         resource.data.courierId == request.auth.uid ||\r\n         resource.data.status == 'pending');\r\n      allow create: if isAuthenticated() && \r\n        request.resource.data.uid_client == request.auth.uid &&\r\n        request.resource.data.status == 'pending';\r\n      allow update: if isAuthenticated() && \r\n        (resource.data.uid_client == request.auth.uid || \r\n         resource.data.courierId == request.auth.uid);\r\n      allow delete: if isAuthenticated() && \r\n        resource.data.uid_client == request.auth.uid &&\r\n        resource.data.status == 'pending';\r\n    }\r\n    \r\n    // Recenzii collection\r\n    match /recenzii/{docId} {\r\n      // Clients can create and read their own reviews\r\n      // Couriers can read reviews about them\r\n      allow read: if isAuthenticated() && \r\n        (resource.data.clientId == request.auth.uid || \r\n         resource.data.courierId == request.auth.uid);\r\n      allow create: if isAuthenticated() && \r\n        request.resource.data.clientId == request.auth.uid;\r\n      allow update, delete: if isAuthenticated() && \r\n        resource.data.clientId == request.auth.uid;\r\n    }\r\n    \r\n    // Counters collection for sequential order numbering\r\n    match /counters/{counterId} {\r\n      // Anyone authenticated can read counters\r\n      allow read: if isAuthenticated();\r\n      // Only allow writes from authenticated users (server will use transactions)\r\n      allow write: if isAuthenticated();\r\n    }\r\n    \r\n    // Transport aeroport collection\r\n    match /transport_aeroport/{docId} {\r\n      // Couriers can manage their airport transport routes\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated() && request.resource.data.uid == request.auth.uid;\r\n      allow update, delete: if isAuthenticated() && resource.data.uid == request.auth.uid;\r\n    }\r\n    \r\n    // Transport persoane collection\r\n    match /transport_persoane/{docId} {\r\n      // Couriers can manage their person transport routes\r\n      allow read: if isAuthenticated();\r\n      allow create: if isAuthenticated() && request.resource.data.uid == request.auth.uid;\r\n      allow update, delete: if isAuthenticated() && resource.data.uid == request.auth.uid;\r\n    }\r\n  }\r\n}\r\n","name":"firestore.rules"}]},"createTime":"2025-12-12T20:45:04.826799Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-12-12T20:45:03.933Z] [rules] created ruleset projects/curierulperfect/rulesets/41e0a8c2-b8be-49bb-9743-95605b0842a4
[info] i  firestore: deploying indexes... 
[debug] [2025-12-12T20:45:03.935Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:03.935Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:03.935Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default)/collectionGroups/-/indexes [none]
[debug] [2025-12-12T20:45:04.015Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default)/collectionGroups/-/indexes 200
[debug] [2025-12-12T20:45:04.015Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default)/collectionGroups/-/indexes {"indexes":[{"name":"projects/curierulperfect/databases/(default)/collectionGroups/comenzi/indexes/CICAgNiav4AK","queryScope":"COLLECTION","fields":[{"fieldPath":"uid_client","order":"ASCENDING"},{"fieldPath":"timestamp","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/curierulperfect/databases/(default)/collectionGroups/calendar_colectii/indexes/CICAgNiroIEK","queryScope":"COLLECTION","fields":[{"fieldPath":"courierId","order":"ASCENDING"},{"fieldPath":"dataTimestamp","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/curierulperfect/databases/(default)/collectionGroups/tarife_curier/indexes/CICAgJj7z4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"uid","order":"ASCENDING"},{"fieldPath":"addedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/curierulperfect/databases/(default)/collectionGroups/comenzi/indexes/CICAgLiIkYMK","queryScope":"COLLECTION","fields":[{"fieldPath":"courierId","order":"ASCENDING"},{"fieldPath":"timestamp","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/curierulperfect/databases/(default)/collectionGroups/comenzi/indexes/CICAgNi47oMK","queryScope":"COLLECTION","fields":[{"fieldPath":"curierId","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/curierulperfect/databases/(default)/collectionGroups/comenzi/indexes/CICAgNi4-ZIK","queryScope":"COLLECTION","fields":[{"fieldPath":"status","order":"ASCENDING"},{"fieldPath":"timestamp","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/curierulperfect/databases/(default)/collectionGroups/comenzi/indexes/CICAgJjFqZMK","queryScope":"COLLECTION","fields":[{"fieldPath":"curierId","order":"ASCENDING"},{"fieldPath":"timestamp","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"}]}
[debug] [2025-12-12T20:45:04.015Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:04.015Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:04.015Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* [none]
[debug] [2025-12-12T20:45:04.066Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* 200
[debug] [2025-12-12T20:45:04.066Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* {"fields":[{"name":"projects/curierulperfect/databases/(default)/collectionGroups/__default__/fields/*","indexConfig":{"indexes":[{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"ASCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"DESCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","arrayConfig":"CONTAINS"}],"state":"READY"}]}}]}
[debug] [2025-12-12T20:45:04.066Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:04.066Z] Checked if tokens are valid: true, expires at: 1765575900237
[debug] [2025-12-12T20:45:04.067Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default) [none]
[debug] [2025-12-12T20:45:04.116Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default) 200
[debug] [2025-12-12T20:45:04.116Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/curierulperfect/databases/(default) {"name":"projects/curierulperfect/databases/(default)","uid":"7ff09d75-2a03-4645-a0d4-72922334f8d2","createTime":"2025-03-30T19:51:47.032263Z","updateTime":"2025-03-30T19:51:47.032263Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-12-12T19:45:05.087517Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IO/Rx7D1uJEDMKmEhMWlzowD"}
[info] i  firestore: The following indexes are defined in your project but are not present in your firestore indexes file:
	(comenzi) -- (courierId,ASCENDING) (timestamp,DESCENDING)  -- Density:SPARSE_ALL  
